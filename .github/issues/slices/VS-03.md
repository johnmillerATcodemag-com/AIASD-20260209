---
title: "VS-03: Select Operation (Command Slice - Equals and Clear)"
labels: ["slice:foundation", "priority:P0", "type:command", "phase:mvp"]
assignees: []
---

## Overview

**Slice Type:** Command (State Modification)
**Priority:** P0 (Critical)
**Effort:** 5 hours
**Risk:** Low
**Dependencies:** VS-01 (Display), VS-02 (Input Digit)

Implement operation buttons (+, -, ×, ÷) that store the operation and first operand for calculation.

## User Story

```
As a user
I want to select an arithmetic operation (+, -, ×, ÷)
So that I can perform calculations between two numbers
```

## Acceptance Criteria

- [ ] Clicking operation buttons (+, -, ×, ÷) stores the operation
- [ ] Current display value is saved as first operand
- [ ] Display is ready to accept next number
- [ ] Selecting operations is possible via keyboard (+, -, \*, /)
- [ ] Subsequent operation selection replaces previous operation
- [ ] Visual indication of selected operation (optional enhancement)
- [ ] Operations follow standard mathematical symbols

## Technical Requirements

**HTML Structure:**

```html
<div class="calculator__buttons">
  <button class="btn btn--operator" data-operator="+">+</button>
  <button class="btn btn--operator" data-operator="-">−</button>
  <button class="btn btn--operator" data-operator="×">×</button>
  <button class="btn btn--operator" data-operator="÷">÷</button>
</div>
```

**State Modification:**

- Reads: `calculatorState.currentValue`
- Modifies: `calculatorState.previousValue` (stores current value)
- Modifies: `calculatorState.operation` (stores selected operation)
- Modifies: `calculatorState.awaitingOperand` (sets to true)
- Modifies: `calculatorState.currentValue` (cleared for next input)

**Business Logic:**

1. Read current `currentValue`
2. If `currentValue` is empty, default to "0"
3. Store `currentValue` in `previousValue`
4. Store selected operation in `operation` (+, -, ×, ÷)
5. Set `awaitingOperand` to true (next digit starts new number)
6. Optionally clear `currentValue` or leave for display
7. Trigger display update

**CSS Requirements:**

- Distinct styling from number buttons (color differentiation)
- Same min-size: 44×44px
- Active/selected state visual feedback
- Accessible contrast ratios

**Operation Symbol Mapping:**

- Internal: `+`, `-`, `*`, `/` (JavaScript operators)
- Display: `+`, `−`, `×`, `÷` (mathematical symbols)

## Test Requirements

- Unit tests for all operators (9 test cases)
- Integration tests with VS-02 (digit input)
- Keyboard operator testing

### Test Cases Summary

| Test Case | Initial State                       | User Action        | Expected Result                                                 | Test Type   |
| --------- | ----------------------------------- | ------------------ | --------------------------------------------------------------- | ----------- |
| TC-V3-01  | `currentValue: "5"`                 | Click "+"          | `previousValue: "5"`, `operation: "+"`, `awaitingOperand: true` | Unit        |
| TC-V3-02  | `currentValue: "10"`                | Click "−"          | `previousValue: "10"`, `operation: "-"`                         | Unit        |
| TC-V3-06  | `operation: "+", currentValue: "5"` | Click "−"          | `operation: "-"` (replaces)                                     | Unit        |
| TC-V3-07  | `currentValue: "7"`                 | Press keyboard "/" | `previousValue: "7"`, `operation: "/"`                          | Integration |

## Implementation Checklist

- [ ] Create HTML operator buttons (+, -, ×, ÷)
- [ ] Implement `handleOperatorInput(operator)` function
- [ ] Add logic to store previousValue and operation
- [ ] Add logic to set awaitingOperand flag
- [ ] Add keyboard event mapping (+, -, \*, /)
- [ ] Create CSS operator button styling
- [ ] Ensure distinct visual styling from number buttons
- [ ] Write unit tests for all operators
- [ ] Write integration tests with VS-02 (digit input)
- [ ] Test operation replacement behavior
