---
title: "VS-25: Multi-Tab Calculation Sessions"
labels:
  [
    "slice:progressive",
    "priority:low",
    "type:feature",
    "phase:v3.0",
    "risk:medium",
  ]
assignees: []
---

## Overview

**Slice Type:** Progressive Enhancement
**Priority:** Low
**Effort:** 10 hours
**Risk:** Medium
**Dependencies:** VS-01 (state management)

Support multiple calculation tabs for parallel calculation workflows.

## User Story

```
As a user working on multiple calculations
I want separate calculator tabs
So that I can work on different calculations simultaneously
```

## Acceptance Criteria

- [ ] Can create multiple calculator tabs
- [ ] Each tab has independent state
- [ ] Tab switching preserves state
- [ ] Can name/label tabs
- [ ] Maximum 10 tabs
- [ ] Tab state persists in session
- [ ] Can close tabs
- [ ] Visual indication of active tab

## Technical Requirements

**Tab State Management:**

```javascript
const tabState = {
  tabs: [],
  activeTabId: null,
  maxTabs: 10,
  nextTabId: 1,
};

function createTab(name = "New Tab") {
  if (tabState.tabs.length >= tabState.maxTabs) {
    return { error: true, message: "Maximum tabs reached" };
  }

  const tab = {
    id: tabState.nextTabId++,
    name: name,
    calculatorState: {
      currentValue: "",
      previousValue: "",
      operation: null,
      awaitingOperand: false,
      displayError: false,
    },
    history: [],
  };

  tabState.tabs.push(tab);
  switchToTab(tab.id);
  return { error: false, tab };
}

function switchToTab(tabId) {
  const tab = tabState.tabs.find((t) => t.id === tabId);
  if (!tab) return;

  // Save current tab state
  if (tabState.activeTabId) {
    const currentTab = tabState.tabs.find((t) => t.id === tabState.activeTabId);
    if (currentTab) {
      currentTab.calculatorState = { ...calculatorState };
    }
  }

  // Load new tab state
  Object.assign(calculatorState, tab.calculatorState);
  tabState.activeTabId = tabId;
  updateDisplay();
}

function closeTab(tabId) {
  const index = tabState.tabs.findIndex((t) => t.id === tabId);
  if (index === -1 || tabState.tabs.length === 1) return;

  tabState.tabs.splice(index, 1);

  if (tabState.activeTabId === tabId) {
    switchToTab(tabState.tabs[0].id);
  }
}
```

**UI Components:**

- Tab bar with tab buttons
- New tab button
- Close tab button
- Tab name editor
- Active tab indicator

## Implementation Checklist

- [ ] Create tab state management
- [ ] Implement create tab function
- [ ] Implement switch tab function
- [ ] Implement close tab function
- [ ] Implement rename tab function
- [ ] Create tab bar UI
- [ ] Add tab creation button
- [ ] Add tab close buttons
- [ ] Style tab bar
- [ ] Implement session persistence
- [ ] Write unit tests
- [ ] Test tab switching
- [ ] Test state isolation
- [ ] Test maximum tab limit
