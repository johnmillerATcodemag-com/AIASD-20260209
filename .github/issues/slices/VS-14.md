---
title: "VS-14: Undo/Redo Functionality"
labels: ["slice:enhancement", "priority:low", "type:feature", "phase:v2.0"]
assignees: []
---

## Overview

**Slice Type:** Feature Enhancement
**Priority:** Low
**Effort:** 8 hours
**Risk:** Medium
**Dependencies:** VS-03 (state management)

Implement undo/redo functionality for calculation steps.

## User Story

```
As a user
I want to undo and redo my actions
So that I can recover from mistakes
```

## Acceptance Criteria

- [ ] Undo button reverses last action
- [ ] Redo button replays undone action
- [ ] Ctrl+Z performs undo
- [ ] Ctrl+Y performs redo
- [ ] Undo history limited to 20 steps
- [ ] Visual indication of undo/redo availability

## Technical Requirements

**History Stack:**

```javascript
const undoRedoState = {
  history: [], // Stack of state snapshots
  currentIndex: -1,
  maxHistory: 20,
};

function saveState() {
  // Save current calculator state
  const snapshot = { ...calculatorState };
  undoRedoState.history = undoRedoState.history.slice(
    0,
    undoRedoState.currentIndex + 1,
  );
  undoRedoState.history.push(snapshot);
  if (undoRedoState.history.length > undoRedoState.maxHistory) {
    undoRedoState.history.shift();
  }
  undoRedoState.currentIndex = undoRedoState.history.length - 1;
}

function undo() {
  if (undoRedoState.currentIndex > 0) {
    undoRedoState.currentIndex--;
    restoreState(undoRedoState.history[undoRedoState.currentIndex]);
  }
}

function redo() {
  if (undoRedoState.currentIndex < undoRedoState.history.length - 1) {
    undoRedoState.currentIndex++;
    restoreState(undoRedoState.history[undoRedoState.currentIndex]);
  }
}
```

## Implementation Checklist

- [ ] Create undo/redo state management
- [ ] Implement state snapshot saving
- [ ] Implement undo function
- [ ] Implement redo function
- [ ] Add undo/redo buttons
- [ ] Add keyboard shortcuts (Ctrl+Z, Ctrl+Y)
- [ ] Disable buttons when unavailable
- [ ] Write unit tests
- [ ] Test history limit
- [ ] Test integration with all operations
