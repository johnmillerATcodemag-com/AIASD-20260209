---
title: "VS-02: Input Digit (Command Slice - Basic Arithmetic)"
labels: ["slice:foundation", "priority:P0", "type:command", "phase:mvp"]
assignees: []
---

## Overview

**Slice Type:** Command (State Modification)
**Priority:** P0 (Critical)
**Effort:** 6 hours
**Risk:** Low
**Dependencies:** VS-01 (Display Current Value)

Enable users to input numbers (0-9) and decimal points through both button clicks and keyboard input.

## User Story

```
As a user
I want to input numbers using buttons or keyboard
So that I can build the calculations I need
```

## Acceptance Criteria

- [ ] Clicking number buttons (0-9) appends digit to display
- [ ] Clicking decimal button (.) adds decimal point
- [ ] Only one decimal point allowed per number
- [ ] Leading zero is removed (e.g., "07" becomes "7")
- [ ] Keyboard input (0-9, .) functions identically to buttons
- [ ] Numbers can be up to 15 digits
- [ ] Decimal precision up to 10 places
- [ ] Visual feedback on button press
- [ ] Buttons are minimum 44×44px (touch target requirement)

## Technical Requirements

**HTML Structure:**

```html
<div class="calculator__buttons">
  <button class="btn btn--number" data-digit="7">7</button>
  <button class="btn btn--number" data-digit="8">8</button>
  <button class="btn btn--number" data-digit="9">9</button>
  <!-- ... additional number buttons ... -->
  <button class="btn btn--number" data-digit="0">0</button>
  <button class="btn btn--decimal" data-digit=".">.</button>
</div>
```

**State Modification:**

- Modifies: `calculatorState.currentValue`
- Modifies: `calculatorState.awaitingOperand` (sets to false)
- Clears: `calculatorState.displayError` (if error was showing)

**Business Logic:**

1. If `awaitingOperand` is true, replace `currentValue` with new digit
2. If `awaitingOperand` is false, append digit to `currentValue`
3. For decimal point:
   - Check if `currentValue` already contains "."
   - If not present, append "."
   - If already present, ignore input
4. Remove leading zeros unless followed by decimal point
5. Limit total length to 15 digits
6. Set `awaitingOperand` to false
7. Trigger display update via VS-01

**CSS Requirements:**

- Button min-size: 44×44px (touch target requirement)
- Active state: Visual feedback on press
- Hover state: Distinct from default
- Focus state: Visible outline for keyboard navigation
- Grid layout: Organized number pad layout

**Validation Rules:**

- Maximum length: 15 digits
- Only one decimal point allowed
- No non-numeric characters (except decimal)
- Leading zero removal (except for "0.xxx")

## Test Requirements

- Unit tests for all logic branches (12 test cases)
- Integration tests with keyboard input
- Touch device testing

### Test Cases Summary

| Test Case | Initial State        | User Action        | Expected Result                  | Test Type   |
| --------- | -------------------- | ------------------ | -------------------------------- | ----------- |
| TC-V2-01  | `currentValue: "0"`  | Click "5"          | `currentValue: "5"`              | Unit        |
| TC-V2-02  | `currentValue: "5"`  | Click "3"          | `currentValue: "53"`             | Unit        |
| TC-V2-03  | `currentValue: "5"`  | Click "."          | `currentValue: "5."`             | Unit        |
| TC-V2-04  | `currentValue: "5."` | Click "."          | `currentValue: "5."` (no change) | Unit        |
| TC-V2-08  | `currentValue: ""`   | Press keyboard "8" | `currentValue: "8"`              | Integration |
| TC-V2-11  | Button click         | -                  | Visual feedback shown            | Visual      |

## Implementation Checklist

- [ ] Create HTML button elements for 0-9 and decimal
- [ ] Implement `handleDigitInput(digit)` function
- [ ] Add digit append logic
- [ ] Add decimal point validation
- [ ] Add maximum length check
- [ ] Add keyboard event listener
- [ ] Create CSS button styling (size, hover, active, focus)
- [ ] Ensure 44×44px minimum button size
- [ ] Write unit tests for all logic branches
- [ ] Write integration tests for keyboard input
- [ ] Perform manual testing on touch devices
